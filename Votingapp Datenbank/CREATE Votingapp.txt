DROP DATABASE IF EXISTS votingapp;

CREATE DATABASE IF NOT EXISTS votingapp;
USE votingapp;

CREATE TABLE Rolle(
Rolle CHAR NOT NULL DEFAULT 'U',
KEY(Rolle)
);

INSERT INTO Rolle (Rolle) VALUES ('U');
INSERT INTO Rolle (Rolle) VALUES ('M');

CREATE TABLE Kategorie(
KID INT PRIMARY KEY NOT NULL,
Bezeichnung TEXT NOT NULL,
KEY(KID)
);

INSERT INTO Kategorie (KID, Bezeichnung) VALUES (1,'gut bürgerlich');
INSERT INTO Kategorie (KID, Bezeichnung) VALUES (2,'asiatisch');
INSERT INTO Kategorie (KID, Bezeichnung) VALUES (3,'italienisch');
INSERT INTO Kategorie (KID, Bezeichnung) VALUES (4,'griechisch');
INSERT INTO Kategorie (KID, Bezeichnung) VALUES (5,'fast food');

CREATE TABLE Person(
PID INT PRIMARY KEY NOT NULL,
Benutzername TEXT NOT NULL,
Klasse TEXT NOT NULL,
Passwort TEXT NOT NULL,
Rolle CHAR NOT NULL,
FOREIGN KEY (Rolle) REFERENCES Rolle (Rolle),
KEY(PID)
);

CREATE TABLE Freund(
PID INT NOT NULL,
FID INT PRIMARY KEY NOT NULL,
FOREIGN KEY(PID) REFERENCES Person(PID)
);

CREATE TABLE Restaurant(
RID INT PRIMARY KEY NOT NULL,
KID INT NOT NULL, 
Name TEXT NOT NULL,
Kategorie TEXT NOT NULL,
FOREIGN KEY (KID) REFERENCES Kategorie(KID),
KEY(RID)
);

CREATE TABLE Bewertung(
PID INT NOT NULL,
RID INT NOT NULL,
Sterne REAL NOT NULL,
Beschreibung Text NOT NULL,
FOREIGN KEY(PID) REFERENCES Person(PID),
FOREIGN KEY(RID) REFERENCES Restaurant(RID)
);

CREATE TABLE Freund(
PID INT NOT NULL,
FID INT PRIMARY KEY NOT NULL,
FOREIGN KEY(PID) REFERENCES Person(PID)
);

CREATE TABLE Klasse(
Name TEXT NOT NULL
);

INSERT INTO Klasse (Name) VALUES ('1AHW');
INSERT INTO Klasse (Name) VALUES ('1BHW');
INSERT INTO Klasse (Name) VALUES ('2AHW');
INSERT INTO Klasse (Name) VALUES ('2BHW');
INSERT INTO Klasse (Name) VALUES ('3AHW');
INSERT INTO Klasse (Name) VALUES ('3BHW');
INSERT INTO Klasse (Name) VALUES ('4AHW');
INSERT INTO Klasse (Name) VALUES ('4BHW');
INSERT INTO Klasse (Name) VALUES ('5AHW');
INSERT INTO Klasse (Name) VALUES ('5BHW');

CREATE TABLE Voting(
PID INT NOT NULL,
RID INT NOT NULL,
FOREIGN KEY(PID) REFERENCES Person(PID),
FOREIGN KEY(RID) REFERENCES Restaurant(RID)
);

CREATE TABLE Adresse(
RID INT NOT NULL,
Postleitzahl TEXT NOT NULL,
Straße TEXT NOT NULL,
Ort TEXT NOT NULL
);
